---
title: "Assignment 04"
output: pdf_document
---

This homework will help you to practice and self assess your knowledge and ability around the course concepts.  Use the answer key to assess your work.  

```{r, echo=FALSE, results = 'hide', message=FALSE, warning=FALSE}
library(tidyverse)
library(exampledata)
knitr::opts_chunk$set(warning = FALSE, fig.width = 4)
```

1. Load the **tidyverse** & **exampledata** packages.

2. View the `wegmans` data set.  Look at the help files for this data sets in order to understand their variables.

3. Re-create this plot.  Hint: determine the variables used and then map them appropriately.  Note that color and alpha have been set to constants.

```{r, echo=FALSE, fig.height = 3}
wegmans %>%
    ggplot(aes(weight, new_price, size = popularity)) +
        geom_point(color = 'gray70', alpha = .7)
```

4. Re-create this plot. Note that you'll need to mutate a variable and combine groups. 

```{r, echo=FALSE, fig.height = 3}
wegmans %>%
    mutate(organic = case_when(
        organic == 'y' ~ 'yes', 
        organic == 'n' ~ 'no', 
        TRUE ~ organic
    )) %>%
    ggplot(aes(weight, new_price)) +
        geom_point(aes(color = organic, shape = organic))
```

5. Add a regression trend-line colored by each organic group to the plot above.

```{r, echo=FALSE, fig.height = 3}
wegmans %>%
    mutate(organic = case_when(
        organic == 'y' ~ 'yes', 
        organic == 'n' ~ 'no', 
        TRUE ~ organic
    )) %>%
    ggplot(aes(weight, new_price, color = organic)) +
        geom_point(aes(shape = organic)) +
        geom_smooth(method = 'lm', fill = NA)
```


6. Use a `mutate` statement to make a `3. high` (> 3), `2. medium` (= 3), and `1. low` (< 3) `popularity2` variable from the `popularity` variable (note that this variable corresponds to the x-axis in the plot).  Then, use faceting to identify the distribution of `popular2` items within departments.  

```{r, echo=FALSE, fig.height = 3}
wegmans %>%
    mutate(popularity2 = case_when(
        popularity > 3 ~ '3.high', 
        popularity == 3 ~ '2. medium', 
        popularity < 3 ~ '1. low'
    )) %>%
    ggplot(aes(popularity2)) +
        geom_bar() +
        facet_wrap(~ department, ncol = 2)
```


